# Forensic Triage Scripts

A collection of Python scripts designed to automate and accelerate the initial analysis of Windows forensic triage images on a Linux-based analysis machine. These tools help in quickly understanding the evidence layout and processing key artifacts.
There will be added more script according to common situations that arise during foresic challanges

---

## 1. Directory & File Lister (`list_directories.py`)

This script generates a clean, tree-like view of all directories and the files within a specified path. It's incredibly useful for getting a quick, high-level overview of the collected evidence and finding the location of specific artifacts without manually navigating through complex folder structures.

### Usage

Run the script from your terminal, providing the path to your triage image as a command-line argument.

```bash
python3 list_directories.py /path/to/your/triage_image
```
Example Output
The script will print a structured list to your console, like this:
```bash

Directory and file tree for: /path/to/your/triage_image/

└── TRIAGE_IMAGE/
    ├── C/
    │   ├── Users/
    │   │   └── Cogwork_Admin/
    │   │       ├── NTUSER.DAT
    │   │       └── AppData/
    │   └── Windows/
    │       └── System32/
    │           ├── config/
    │           │   ├── SAM
    │           │   └── SYSTEM
    │           └── winevt/
    │               └── Logs/
    │                   └── Security.evtx
```

## 2. Automatic Artifact Processor (`auto_triage.sh`)

This Bash script automates the initial processing of key Windows forensic artifacts. It scans a triage image, identifies high-value files (like Event Logs, Registry Hives, and the $MFT), and automatically runs the appropriate Zimmerman's EZ Tool to parse them into a human-readable CSV format.

### Prerequisites

Before running this script, ensure you have the following installed and configured:

* **Zimmerman's EZ Tools**: Downloaded and extracted to a known location (e.g., `/home/nukitaro/EZTools`).
* **.NET Runtime**: Required to execute the EZ Tools' `.dll` files.
* **Sudo access**: The script needs `sudo` to run the tools properly.

### Configuration

You must edit the configuration variables at the top of the `auto_triage.sh` script to match the paths on your system.

```bash
#!/bin/bash

# --- CONFIGURATION ---
# Base directory where your analysis folder will be created.
DOWNLOADS_DIR="/home/nukitaro/Downloads"
# Path to your Zimmerman EZTools folder (e.g., the .NET 9 version).
EZTOOLS_DIR="/home/nukitaro/EZTools/net9"
# Full path to the dotnet executable.
DOTNET_PATH="/home/nukitaro/.dotnet/dotnet"
# Name of the main output folder for all analysis.
ANALYSIS_FOLDER_NAME="Analisys"
# --- END CONFIGURATION ---
```
Usage
Run the script from your terminal, providing the path to the root of the triage image you want to process.

```Bash
sudo ./auto_triage.sh /path/to/your/triage_image
```

### How It Works
1 - The script first creates an Analisys directory in your specified DOWNLOADS_DIR.

2 - It then uses the find command to automatically locate the necessary EZ Tool .dll files within your EZTOOLS_DIR.

3 - It scans the entire triage image for a predefined list of known artifact filenames (e.g., Security.evtx, SYSTEM, $MFT).

4- For each artifact it finds, it runs the correct Zimmerman tool (EvtxECmd, RECmd, etc.), printing the tool's full output to the terminal for real-time feedback.

5 - It saves the processed output (as CSVs) into neatly organized subfolders within the Analisys directory, named after the artifact that was processed (e.g., Analisys/Security.evtx_parsed/).

#### Targeted Artifacts
The script is configured to automatically find and process the following high-value forensic artifacts:

**SYSTEM**	
- A core registry hive containing system-wide configuration like services, hardware, and boot settings.
**NTUSER.DAT**
- 	A user-specific registry hive with settings for a particular user, including preferences and recent activity.
**Amcache.hve**	
- A registry hive that tracks program executions, providing a timeline of which applications were run.
Security.evtx	
- The Security Event Log, which records logons, process creation, account changes, and other key security events.
**System.evtx**	
- The System Event Log, which records events generated by the Windows operating system itself.
Application.evtx	
- The Application Event Log, which records events from software installed on the system.
**...PowerShell%4Operational.evtx**	
- The PowerShell Operational Log, which provides detailed logs of all PowerShell activity, including full script contents.
**...User Profile Service...evtx**	
- Logs the activity of user profile loading and unloading during logon and logoff.
**$MFT**	
- The Master File Table, the index of the entire NTFS file system containing metadata for every file and folder.
**$UsnJrnl**	
- The Update Sequence Number Journal, a log of all changes (creations, deletions, modifications) to files.